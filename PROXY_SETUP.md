# 代理设置说明

## 为什么需要代理？

由于网络环境限制，可能无法直接访问 Binance 和 CoinCap API。通过设置代理，可以让 Next.js 服务器通过代理访问这些外部 API。

## 使用方法

### 方法 1：使用启动脚本（推荐）

```bash
./start-with-proxy.sh
```

这个脚本会自动设置代理环境变量并启动开发服务器。

### 方法 2：使用 npm 脚本

```bash
npm run dev:proxy
```

### 方法 3：手动设置环境变量

在启动开发服务器之前，先设置代理环境变量：

```bash
export https_proxy=http://127.0.0.1:7897
export http_proxy=http://127.0.0.1:7897
export all_proxy=socks5://127.0.0.1:7897
npm run dev
```

### 方法 4：在 .env.local 中配置（Next.js 不会自动读取，但可以创建启动脚本）

创建 `.env.local` 文件（可选，用于记录代理配置）：

```env
HTTPS_PROXY=http://127.0.0.1:7897
HTTP_PROXY=http://127.0.0.1:7897
ALL_PROXY=socks5://127.0.0.1:7897
```

## 代理配置说明

- **HTTP/HTTPS 代理**: `http://127.0.0.1:7897`
- **SOCKS5 代理**: `socks5://127.0.0.1:7897`
- **代理端口**: `7897`（请根据你的实际代理端口修改）

## 验证代理是否生效

启动服务器后，尝试使用"财富时光机"工具，选择"尝试获取实时数据"模式。如果代理配置正确，应该能够成功获取 Binance 或 CoinCap 的实时数据。

## 注意事项

1. **确保代理服务正在运行**：在启动 Next.js 服务器之前，确保你的代理服务（如 Clash、V2Ray 等）已经启动并监听在 `127.0.0.1:7897`
2. **端口可能不同**：如果你的代理使用不同的端口，请修改脚本中的端口号
3. **生产环境**：在生产环境中，建议通过环境变量或服务器配置来设置代理，而不是硬编码

## 故障排查

如果代理设置后仍然无法访问 API：

1. 检查代理服务是否正常运行
2. 测试代理是否可用：
   ```bash
   curl --proxy http://127.0.0.1:7897 https://api.binance.com/api/v3/ping
   ```
3. 检查防火墙设置
4. 查看 Next.js 服务器日志中的错误信息

