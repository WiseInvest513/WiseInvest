# Word æ–‡æ¡£æ”¯æŒ - å®‰è£…å’Œä½¿ç”¨æŒ‡å—

## âœ… åŠŸèƒ½å·²å®ç°

ç³»ç»Ÿç°åœ¨æ”¯æŒç›´æ¥ä» Word æ–‡æ¡£ï¼ˆ.docxï¼‰è¯»å–æ–‡ç« å†…å®¹å¹¶å±•ç¤ºã€‚

## ğŸ“¦ å®‰è£…ä¾èµ–

é¦–å…ˆéœ€è¦å®‰è£… Word æ–‡æ¡£è§£æåº“ï¼š

```bash
npm install mammoth
```

å¦‚æœé‡åˆ°æƒé™é—®é¢˜ï¼Œå¯ä»¥å°è¯•ï¼š

```bash
npm install mammoth --save
```

## ğŸ“ ç›®å½•ç»“æ„

Word æ–‡æ¡£åº”è¯¥æ”¾åœ¨ä»¥ä¸‹ç›®å½•ï¼š

```
lib/anthology/documents/
â”œâ”€â”€ README.md
â””â”€â”€ {æ–‡ç« ID}.docx  â† ä½ çš„ Word æ–‡æ¡£æ”¾è¿™é‡Œ
```

## ğŸš€ ä½¿ç”¨æ­¥éª¤

### 1. å‡†å¤‡ Word æ–‡æ¡£

- åˆ›å»ºæˆ–ç¼–è¾‘ Word æ–‡æ¡£ï¼ˆ.docx æ ¼å¼ï¼‰
- ä¿å­˜åˆ° `lib/anthology/documents/` ç›®å½•
- æ–‡ä»¶åæ ¼å¼ï¼š`{æ–‡ç« ID}.docx`

**ç¤ºä¾‹ï¼š**
- æ–‡ç«  IDï¼š`buffett-letter-1981`
- æ–‡ä»¶åï¼š`buffett-letter-1981.docx`
- å®Œæ•´è·¯å¾„ï¼š`lib/anthology/documents/buffett-letter-1981.docx`

### 2. åœ¨ metadata.ts ä¸­æ·»åŠ å…ƒæ•°æ®

ç¼–è¾‘ `lib/anthology/metadata.ts`ï¼Œæ·»åŠ æ–‡ç« å…ƒæ•°æ®ï¼š

```typescript
export const knowledgeBaseMetadata: Author[] = [
  {
    name: "å·´è²ç‰¹ (Buffett)",
    categories: [
      {
        name: "è‡´è‚¡ä¸œä¿¡",
        articles: [
          { id: "buffett-letter-1980", title: "1980å¹´è‡´è‚¡ä¸œä¿¡" },
          { id: "buffett-letter-1981", title: "1981å¹´è‡´è‚¡ä¸œä¿¡" }, // â† æ–°æ–‡ç« 
        ],
      },
    ],
  },
];
```

**é‡è¦ï¼š**
- `id` å¿…é¡»ä¸ Word æ–‡ä»¶åï¼ˆä¸å«æ‰©å±•åï¼‰å®Œå…¨ä¸€è‡´
- `title` æ˜¯æ˜¾ç¤ºåœ¨åˆ—è¡¨ä¸­çš„æ ‡é¢˜

### 3. é‡å¯å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

### 4. è®¿é—®é¡µé¢

è®¿é—® `http://localhost:3002/anthology`ï¼Œå³å¯çœ‹åˆ°æ–‡ç« åˆ—è¡¨å’Œå†…å®¹ã€‚

## ğŸ”„ åŠ è½½ä¼˜å…ˆçº§

ç³»ç»ŸæŒ‰ä»¥ä¸‹é¡ºåºåŠ è½½æ–‡ç« å†…å®¹ï¼š

1. **ä¼˜å…ˆ**ï¼šä» `data.ts` åŠ è½½ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
2. **å…¶æ¬¡**ï¼šä» Word æ–‡æ¡£åŠ è½½ï¼ˆå¦‚æœå­˜åœ¨ï¼‰

å¦‚æœåŒä¸€ç¯‡æ–‡ç«  ID åœ¨ `data.ts` ä¸­å­˜åœ¨ï¼Œä¼šä¼˜å…ˆä½¿ç”¨ `data.ts` çš„å†…å®¹ã€‚

## ğŸ“ æ ¼å¼æ”¯æŒ

Word æ–‡æ¡£ä¸­çš„æ ¼å¼ä¼šè‡ªåŠ¨è½¬æ¢ä¸º Markdownï¼š

| Word æ ¼å¼ | Markdown |
|----------|----------|
| æ ‡é¢˜ 1 | `# æ ‡é¢˜` |
| æ ‡é¢˜ 2 | `## æ ‡é¢˜` |
| æ ‡é¢˜ 3 | `### æ ‡é¢˜` |
| **ç²—ä½“** | `**ç²—ä½“**` |
| *æ–œä½“* | `*æ–œä½“*` |
| åˆ—è¡¨ | `- åˆ—è¡¨é¡¹` |

**æ³¨æ„ï¼š** å¤æ‚çš„æ ¼å¼ï¼ˆå¦‚è¡¨æ ¼ã€å›¾ç‰‡ç­‰ï¼‰å¯èƒ½ä¼šä¸¢å¤±ï¼Œå»ºè®®ä½¿ç”¨ç®€å•çš„æ–‡æœ¬æ ¼å¼ã€‚

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä»…æœåŠ¡å™¨ç«¯æ”¯æŒ**ï¼šWord æ–‡æ¡£è¯»å–åªåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œï¼Œå®¢æˆ·ç«¯ä¼šçœ‹åˆ°è½¬æ¢åçš„ Markdown å†…å®¹
2. **æ–‡ä»¶æƒé™**ï¼šç¡®ä¿æ–‡ä»¶æœ‰è¯»å–æƒé™
3. **æ–‡ä»¶ç¼–ç **ï¼šä½¿ç”¨ UTF-8 ç¼–ç çš„ .docx æ–‡ä»¶
4. **ç¼“å­˜æœºåˆ¶**ï¼šæ–‡æ¡£å†…å®¹ä¼šè¢«ç¼“å­˜ï¼Œä¿®æ”¹æ–‡æ¡£åéœ€è¦é‡å¯æœåŠ¡å™¨æ‰èƒ½çœ‹åˆ°æ›´æ–°

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šæ–‡æ¡£åŠ è½½å¤±è´¥

**æ£€æŸ¥ï¼š**
1. æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼š`lib/anthology/documents/{æ–‡ç« ID}.docx`
2. æ–‡ä»¶åæ˜¯å¦ä¸æ–‡ç«  ID å®Œå…¨ä¸€è‡´
3. mammoth åº“æ˜¯å¦å·²å®‰è£…ï¼š`npm list mammoth`

### é—®é¢˜ï¼šå®‰è£… mammoth å¤±è´¥

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆéœ€è¦ >= 18.0.0ï¼‰
- å°è¯•æ¸…ç†ç¼“å­˜ï¼š`npm cache clean --force`
- ä½¿ç”¨ä»£ç†å®‰è£…ï¼š`npm install mammoth --registry https://registry.npmmirror.com`

### é—®é¢˜ï¼šæ ¼å¼è½¬æ¢ä¸æ­£ç¡®

**è¯´æ˜ï¼š** mammoth åº“ä¸»è¦å°† Word è½¬æ¢ä¸º HTMLï¼Œç„¶åç®€åŒ–ä¸º Markdownã€‚å¤æ‚çš„æ ¼å¼å¯èƒ½ä¸ä¼šå®Œç¾è½¬æ¢ã€‚å»ºè®®ï¼š
- ä½¿ç”¨ç®€å•çš„æ–‡æœ¬æ ¼å¼
- æˆ–è€…æ‰‹åŠ¨ç¼–è¾‘ `data.ts` æ–‡ä»¶ï¼Œä½¿ç”¨çº¯ Markdown

## ğŸ“š ç¤ºä¾‹

å®Œæ•´ç¤ºä¾‹è¯·å‚è€ƒï¼š
- `lib/anthology/metadata.ts` - å…ƒæ•°æ®ç¤ºä¾‹
- `lib/anthology/documents/README.md` - æ–‡æ¡£ç›®å½•è¯´æ˜

## ğŸ”— ç›¸å…³æ–‡æ¡£

- [æ–‡é›†æ•°æ®ç®¡ç† README](./README.md)
- [mammoth å®˜æ–¹æ–‡æ¡£](https://github.com/mwilliamson/mammoth.js)
